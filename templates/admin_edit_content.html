{% extends 'base.html' %}
{% block title %}تعديل محتوى{% endblock %}
{% block content %}
<h4>تعديل محتوى</h4>
<form method="post" enctype="multipart/form-data">
  <div class="mb-3">
    <label class="form-label">عنوان</label>
    <input name="title" class="form-control" value="{{ content.title }}">
  </div>
  <div class="mb-3">
    <label class="form-label">HTML</label>
    <textarea id="htmlEditor" name="html" class="form-control" rows="6">{{ content.html }}</textarea>
  </div>
  <div class="mb-3">
    <label class="form-label">رفع ملف (اختياري)</label>
    <input type="file" name="file" class="form-control">
  </div>
  <div class="mb-3">
    <label class="form-label">رابط (اختياري)</label>
    <input name="link" class="form-control" value="{{ content.link }}">
  </div>
  <div class="mb-3">
    <label class="form-label">تصنيفات (مفصولة بفاصلة)</label>
    <input name="categories" class="form-control" value="{{ content.categories }}">
  </div>
  <div class="mb-3">
    <label class="form-label">الصفوف</label>
    <div>
      {% for u in users %}
        {% set checked = u.grade|string in (content.grades or '') %}
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" name="grades" value="{{ u.grade }}" id="g{{ u.grade }}" {% if checked %}checked{% endif %}>
          <label class="form-check-label" for="g{{ u.grade }}">{{ u.grade }}</label>
        </div>
      {% endfor %}
    </div>
  </div>
  <div class="d-grid"><button class="btn btn-primary">احفظ</button></div>
</form>
<script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/6/tinymce.min.js" referrerpolicy="origin" nonce="{{ csp_nonce() }}"></script>
<script nonce="{{ csp_nonce() }}">
  tinymce.init({ selector: '#htmlEditor', height: 300, menubar: false, images_upload_url: '/admin/upload_image' });
</script>
{% endblock %}
